lrp2plot(lcart.mod1)
library(longRPart2)
library(longRPart2)
library(longRPart2)
library(longRPart2)
?rhs.vars
library(nlme)
?rhs.vars
install.packages("formula.tools")
library(longRPart2)
install.packages("ggplot2")
library(longRPart2)
library(longRPart2)
library(longRPart2)
lrp2Plot(lcart.mod1)
summary(lcart.mod1)
lcart.mod1
lrpTreePlot(lcart.mod1$rpart_out,use.n=F) # not working
lrpPlot(lcart.mod1) # not working
plot(lcart.mod1$rpart_out);text(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
for(j in 1:length(table(lcart.mod1$where))){
id <- names(table(lcart.mod1$where))[j]==lcart.mod1$where
}
as.numeric(names(table(lcart.mod1$rpart_out$where)))
lcart.mod1$params.nlme
lcart.mod1$summary
lrp2Plot(lcart.mod2)
lrp2Plot(lcart.mod1)
install.packages("formula.tools")
library(longRPart2)
install.packages("nlme")
library(longRPart2)
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long)
lrpCV(lcart.mod1)
lcart.mod1
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
lrpCV(lcart.mod1)
printcp(lcart.mod1$rpart_out)
round(rnorm(nrow(wisc.verg)),2)
round(rnorm(nrow(wisc.verb)),2)
wisc.verb.noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
head(wisc.long)
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
head(wisc.long)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
head(wisc.long)
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
printcp(lcart.mod1$rpart_out)
summary(lcart.mod1)
lcart.mod1
lrp2Plot(lcart.mod1)
lrpTreePlot(lcart.mod1,use.n=F)
lcart.mod1$rpart_out
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
plot(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=1))
plot(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=5))
lcart.mod1
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
printcp(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
1865/304
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=0.005))
printcp(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
1865+3251
2987+233+1865
2987+233+1865
5085*.01
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
5085*.005
printcp(lcart.mod1$rpart_out)
-2 * model.0$logLik
summary(mix1) # get same estimates as in LGM, notice SD not VAR
wisc <- read.table("C:/Users/RJacobucci/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/jacobucc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
#wisc <- read.table(file.choose()) # use directory to find wisc4vpe.dat
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
# install longRPart2 from source
wisc.verb <- wisc[,c(1:4,9)]
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
## longRPart2
?lme
lme1 <- lme(verbal ~ grade,random=~1|id,
data=wisc.long)
-2 * lme1$logLik
lme2 <- lme(verbal ~ grade,random=~1,
data=wisc.long)
lme2 <- lme(verbal ~ grade,random=~id,
data=wisc.long)
lme2 <- lme(verbal ~ grade,
data=wisc.long)
lme2 <- lme(verbal ~ grade,data=wisc.long)
lme2 <- lme(verbal ~ grade,data=wisc.long,random=~1)
lme2 <- lme(verbal ~ grade,data=wisc.long,random=~grade)
lme2 <- lme(verbal ~ grade,data=wisc.long,random= ~ grade)
lme2 <- lme(verbal ~ grade,data=wisc.long,random= ~1|id)
lme2 <- lme(verbal ~ 1,data=wisc.long,random= ~1|id)
-2 * lme2$logLik
anova(lme1,lme2)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long)
lcart.mod1
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
wisc <- read.table("C:/Users/RJacobucci/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/jacobucc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
summary(lcart.mod1)
plot(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
?rpart.control
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
lcart.mod1$rpart_out
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
lcart.mod1$rpart_out
.01*5220
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
lme1 <- lme(verbal ~ grade,random=~1|id,wisc.long)
anova(lme1)
lme1
summary(lme1)
?lme
anova(lme1)
BIC(lme1)
summary(lme)
summary(lme1)
anova(lme1)
str(lme1)
.001*5000
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.005))
lcart.mod1$rpart_out
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.005))
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
?rpart.control
library(rpart)
?rpart.control
wisc <- read.table("C:/Users/RJacobucci/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/jacobucc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
printcp(lcart.mod1$rpart_out)
summary(lcart.mod1)
lcart.mod1
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.01))
printcp(lcart.mod1$rpart_out)
lcart.mod1
-1625.63-932.88
-2558.51*2
lcart.mod1$rpart_out
printcp(lcart.mod1$rpart_out)
-2558.51*2
5115/5220.5
5115.02/5220.5
5220.5-20
5200.5/5220.5
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
min.dev=50)
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
min.dev=20)
printcp(lcart.mod1$rpart_out)
23*(1/7)
28*(1/6)
sqrt(4.7)
.7**2
.3**2
2.3**2
1.7**2
.49+.49+.09+5.29+5.29+2.9+2.9
17.45*(1/6)
sqrt(2.9)
(1/2.2)*(.7/1.7)
(-1/2.2)*(-.3*1.7)
(-2/2.2)*(-2.3*1.7)
(-3/2.2)*(-2.3*1.7)
(3/2.2)*(1.7/1.7)
(2/2.2)*1
.91+1.36+5.33+3.55+.23+.19+0
(-3/2.2)*(-2.3/1.7)
(-3/2.2)*(-2.3/1.7)
(-1/2.2)*(-.3/1.7)
(-2/2.2)*(-2.3/1.7)
.19+.08+1.22+1.84+1.36+.91
5.6*(1/6)
.93*(1.7/2.2)
3.3-(.718*5)
x = c(5,6,4,3,2,8,7)
y=c(4,4,3,1,1,5,5)
lm(y~x)
summary(x)
sd(x)
sd(y)
mean(y)
cor(x,y)
.95*(1.7/2.16)
-.29+(.718*5)
-.29+(.718*6)
library(longRPart2)
