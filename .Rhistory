head(ex.data.1)
# Convert to Long Form
ex.data.2 = reshape(ex.data.1, idvar='id',
varying=c('y1','y2','y3','y4','y5','y6'),
times=c(0,1,2,3,4,5),
v.names='y', direction='long')
ex.data.2 = ex.data.2[order(ex.data.2$id, ex.data.2$time),]
head(ex.data.2)
### Beginning of what package would be
## Things to Specify
#1 longitudinal model (e.g., y~b0i+b1i*(time/5))
#2 fixed-effect parameters (e.g., fixed=b0i+b1i~1)
#3 random-effect parameters (e.g., random=b0i+b1i~1)
#4 data
#5 Participant ID variable (e.g., group=~id)
#6 Starting values for fixed-effects parameters (e.g., start=c(10,5))
#7 Covariates used for splitting
#8 Model Type ('Fixed', 'Fixed+Ran', 'Fixed+Ran+Res')
#9 Minimum number of participants per node (Nmin)
#10 Criterion (e.g., Change in -2LL, p-value, CV)
# Run NLME
require(nlme)
model.0 = nlme(y~b0i+b1i*time,
data=ex.data.2,
fixed=b0i+b1i~1,
random=b0i+b1i~1,
group=~id,
start=c(10,5))
summary(model.0)
dev.root = -2 * model.0$logLik
lcart.mod1 <- longRPart2(method="nlme",
nlme.model=y~b0i+b1i*time,
fixedFormula=b0i+b1i~1,
rPartFormula = ~ z,
group= ~ id,
randomFormula=b0i+b1i~1,
data=ex.data.2,
start=c(10,5))
str(lcart.mod1)
lcart.mod1$where
plot(lcart.mod1);text(lcart.mod1)
lcart.mod1$where
str(lcart.mod1)
length(table(lcart.mod1$where)
length(table(lcart.mod1$where))
lcart.mod1$where
table(lcart.mod1$where)
j=1
table(lcart.mod1$where)[j]
table(lcart.mod1$where)[j][1]
table(lcart.mod1$where)[j]==lcart.mod1$where
table(lcart.mod1$where)[j]
table(lcart.mod1$where)
names(table(lcart.mod1$where))[j]==lcart.mod1$where
summary(model.0)
library(longRPart2)
lcart.mod1 <- longRPart2(method="nlme",
nlme.model=y~b0i+b1i*time,
fixedFormula=b0i+b1i~1,
rPartFormula = ~ z,
group= ~ id,
randomFormula=b0i+b1i~1,
data=ex.data.2,
start=c(10,5))
lcart.mod1$params.nlme
library(longRPart2)
lcart.mod1 <- longRPart2(method="nlme",
nlme.model=y~b0i+b1i*time,
fixedFormula=b0i+b1i~1,
rPartFormula = ~ z,
group= ~ id,
randomFormula=b0i+b1i~1,
data=ex.data.2,
start=c(10,5))
lcart.mod1$params.nlme
params(model.0)
parameters(model.0)
coef(model.0)
lcart.mod1$params.nlme
lcart.mod1$rpart_out
model.rpart$where
table(model.rpart$where)
table(lcart.mod1$rpart_out$where)
names(table(lcart.mod1$rpart_out$where))
as.numeric(names(table(lcart.mod1$rpart_out$where)))
library(longRPart2)
lcart.mod1 <- longRPart2(method="nlme",
nlme.model=y~b0i+b1i*time,
fixedFormula=b0i+b1i~1,
rPartFormula = ~ z,
group= ~ id,
randomFormula=b0i+b1i~1,
data=ex.data.2,
start=c(10,5))
lcart.mod1$params.nlme
library(longRPart2)
library(longRPart2)
library(longRPart2)
library(longRPart2)
library(longRPart2)
plot.longrpart2(lcart.mod1)
plot(lcart.mod1)
load("C:/Users/jacobucc/Downloads/longrpart2 test models.RData")
plot(lcart.mod1)
plot.longrpart2(lcart.mod1)
lrp2plot(lcart.mod1)
library(longRPart2)
library(longRPart2)
library(longRPart2)
library(longRPart2)
?rhs.vars
library(nlme)
?rhs.vars
install.packages("formula.tools")
library(longRPart2)
install.packages("ggplot2")
library(longRPart2)
library(longRPart2)
library(longRPart2)
lrp2Plot(lcart.mod1)
summary(lcart.mod1)
lcart.mod1
lrpTreePlot(lcart.mod1$rpart_out,use.n=F) # not working
lrpPlot(lcart.mod1) # not working
plot(lcart.mod1$rpart_out);text(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
for(j in 1:length(table(lcart.mod1$where))){
id <- names(table(lcart.mod1$where))[j]==lcart.mod1$where
}
as.numeric(names(table(lcart.mod1$rpart_out$where)))
lcart.mod1$params.nlme
lcart.mod1$summary
lrp2Plot(lcart.mod2)
lrp2Plot(lcart.mod1)
install.packages("formula.tools")
library(longRPart2)
install.packages("nlme")
library(longRPart2)
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long)
lrpCV(lcart.mod1)
lcart.mod1
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
lrpCV(lcart.mod1)
printcp(lcart.mod1$rpart_out)
round(rnorm(nrow(wisc.verg)),2)
round(rnorm(nrow(wisc.verb)),2)
wisc.verb.noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
head(wisc.long)
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
head(wisc.long)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
head(wisc.long)
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
## longRPart2
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=10))
printcp(lcart.mod1$rpart_out)
summary(lcart.mod1)
lcart.mod1
lrp2Plot(lcart.mod1)
lrpTreePlot(lcart.mod1,use.n=F)
lcart.mod1$rpart_out
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
plot(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(xval=1))
plot(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=5))
lcart.mod1
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
printcp(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
1865/304
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=0.005))
printcp(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
1865+3251
2987+233+1865
2987+233+1865
5085*.01
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
5085*.005
printcp(lcart.mod1$rpart_out)
-2 * model.0$logLik
summary(mix1) # get same estimates as in LGM, notice SD not VAR
wisc <- read.table("C:/Users/RJacobucci/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/jacobucc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
fm1 <- nlme(height ~ SSasymp(age, Asym, R0, lrc),
data = Loblolly,
fixed = Asym + R0 + lrc ~ 1,
random = Asym ~ 1,
start = c(Asym = 103, R0 = -8.5, lrc = -3.3))
mix1 <- nlme(verbal ~ SSasymp(), random = ~ grade | id,start=c(1,1),
fixed = b0i + b1i | 1,
data = wisc.long, method="ML" )
summary(mix1) # get same estimates as in LGM, notice SD not VAR
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
#wisc <- read.table(file.choose()) # use directory to find wisc4vpe.dat
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
# install longRPart2 from source
wisc.verb <- wisc[,c(1:4,9)]
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[2] <- "grade"
names(wisc.long.sel)[2] <- "grade"
## longRPart2
?lme
lme1 <- lme(verbal ~ grade,random=~1|id,
data=wisc.long)
-2 * lme1$logLik
lme2 <- lme(verbal ~ grade,random=~1,
data=wisc.long)
lme2 <- lme(verbal ~ grade,random=~id,
data=wisc.long)
lme2 <- lme(verbal ~ grade,
data=wisc.long)
lme2 <- lme(verbal ~ grade,data=wisc.long)
lme2 <- lme(verbal ~ grade,data=wisc.long,random=~1)
lme2 <- lme(verbal ~ grade,data=wisc.long,random=~grade)
lme2 <- lme(verbal ~ grade,data=wisc.long,random= ~ grade)
lme2 <- lme(verbal ~ grade,data=wisc.long,random= ~1|id)
lme2 <- lme(verbal ~ 1,data=wisc.long,random= ~1|id)
-2 * lme2$logLik
anova(lme1,lme2)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat,
randomFormula=~1|id,
data=wisc.long)
lcart.mod1
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
wisc <- read.table("C:/Users/RJacobucci/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/jacobucc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
wisc <- read.table("C:/Users/rjacobuc/Documents/GitHub/EDM_Labs/2015/wisc4vpe.dat")
names(wisc)<- c("V1","V2","V4","V6","P1","P2","P4", "P6", "Moeducat")
wisc.verb <- wisc[,c(1:4,9)]
wisc.verb$noise <- round(rnorm(nrow(wisc.verb)),2)
# create subset for plotting
ntot <- nrow(wisc.verb)    # total number of observations
wisc.verb.sel <- wisc.verb[sample(ntot, 30), ]
wisc.long <- reshape(wisc.verb, varying = c("V1", "V2", "V4", "V6"), v.names = "verbal",
times = c(1, 2, 4, 6), direction = "long")
wisc.long.sel <- reshape(wisc.verb.sel, varying = c("V1", "V2", "V4", "V6"),
v.names = "verbal", times = c(1, 2, 4, 6),
direction = "long")
head(wisc.long,3)
names(wisc.long)[3] <- "grade"
names(wisc.long.sel)[3] <- "grade"
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
summary(lcart.mod1)
plot(lcart.mod1$rpart_out)
lcart.mod1$rpart_out
?rpart.control
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
lcart.mod1$rpart_out
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control())
lcart.mod1$rpart_out
.01*5220
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.001))
printcp(lcart.mod1$rpart_out)
lme1 <- lme(verbal ~ grade,random=~1|id,wisc.long)
anova(lme1)
lme1
summary(lme1)
?lme
anova(lme1)
BIC(lme1)
summary(lme)
summary(lme1)
anova(lme1)
str(lme1)
.001*5000
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.005))
lcart.mod1$rpart_out
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.005))
printcp(lcart.mod1$rpart_out)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
lcart.mod1 <- longRPart2(method="lme",
fixedFormula=verbal ~ grade,
rPartFormula = ~ Moeducat + noise,
randomFormula=~1|id,
data=wisc.long,
control=rpart.control(cp=.0025))
printcp(lcart.mod1$rpart_out)
library(longRPart2)
